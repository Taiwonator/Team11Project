<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../../public/styles/navs.css">
    <link rel="stylesheet" href="../../public/styles/index.css">
    <title>Log Call</title>
</head>
<body>
    <nav class='top-nav'>
        <div class="top-nav-left">
            <h2 class="top-nav-company">Make-It-All</h2>
        </div>
        <div class="top-nav-right">
            <h3 class="top-nav-text">Welcome Operator</h3>
            <a class="top-nav-button" href="../../login.html">Logout</a>
        </div>
    </nav>

    <nav id='operator-side-nav'></nav>

    <div class="page">
        <div class="page-content scroll">
            <h1 class="title">Log A Problem</h1>

            <div class="search-element">
                <h3 class="element-title">Caller</h3>
                <div class="search-element-bar">
                    <input type="text" placeholder="Enter name" onkeyup="searchTable(event, 1)">
                    <button><i class="fa fa-search"></i></button>
                </div>
                <table class="search-element-table">
                    <tr>
                        <th>Employee ID</th>
                        <th>Name</th>
                        <th>Extension</th>
                        <th>Job Title</th>
                        <th>Department</th>
                        <th>Email</th>
                        <th>Branch ID</th>
                    </tr>
                    <tr>
                        <td>E001</td>
                        <td>Harriet Simmons</td>
                        <td>0</td>
                        <td>DP Officer</td>
                        <td>Legal</td>
                        <td>franya@kurupee.com</td>
                        <td>B0001</td>
                    </tr>
                    <tr>
                        <td>E002</td>
                        <td>Allan Tomly</td>
                        <td>1</td>
                        <td>Diversity Coach</td>
                        <td>Social</td>
                        <td>ymar@hsmty.com</td>
                        <td>B0001</td>
                    </tr>
                    <tr>
                        <td>E003</td>
                        <td>Samuel Tyson</td>
                        <td>2</td>
                        <td>Software Engineer</td>
                        <td>Technical</td>
                        <td>lusa_2006n@coronagg.com</td>
                        <td>B0002</td>
                    </tr>
                </table>
            </div>

            <div class="date-input-element">
                <h3 class="element-title">Date</h3>
                <input type="date">
            </div>

            <div class="text-area-input-element">
                <h3 class="element-title">Reason for call</h3>
                <textarea class="scroll"></textarea>
            </div>



            <!-- https://www.w3schools.com/howto/tryit.asp?filename=tryhow_js_tabs_close -->
            <div class="tab" id="tabs">
                <!-- <div class="tablinks-container">
                    <button class="tablinks" onclick="openTab(event, 'Problem1')" id="defaultOpen">Problem 1</button>
                    <i class="fa fa-times deletetab" onclick="deleteTab(event)"></i>
                </div> -->

                <button class="addtab" onclick="addTab()"><i class="fa fa-plus"></i></button>
              </div>
              
              <div id="tab-contents">
                <!-- <div id="Problem1" class="tabcontent">
                    <span onclick="this.parentElement.style.display='none'" class="topright">&times</span>
                    <h3>Problem 1</h3>
                </div> -->
                
              </div>

            <button class="big-button"><a href="./activeProblems.html">Confirm</a></button>
        </div>
    </div>
    <script>
        //https://www.w3schools.com/howto/tryit.asp?filename=tryhow_js_tabs_close
        function openTab(evt, problemName, plus) {
            var i, tabcontent, tablinks;
            tabcontent = document.getElementsByClassName("tabcontent");
            for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].style.display = "none";
            }
            tablinks = document.getElementsByClassName("tablinks");
            for (i = 0; i < tablinks.length; i++) {
                tablinks[i].className = tablinks[i].className.replace(" active", "");
            }
            document.getElementById(problemName).style.display = "block";
            if(plus) {
                for(var i = 0; i < tablinks.length; i++) {
                    if (tablinks[i].dataset.name == problemName) {
                        tablinks[i].className += " active";
                    }
                }
            }
            evt.currentTarget.className += " active";
        }

        // Not w3chools
        var tabCount = document.getElementsByClassName("tablinks").length;
        var problemCount = 1;

        function deleteTab(evt) {
            if(tabCount != 1) {
                evt.target.parentElement.remove();
                tabCount--;
                document.getElementById(evt.target.dataset.name).remove();
            }
        }

        window.onload = function() {
            addTab();
        }

        function addTab() {
            const problemString = `<div class="new-problem" data-name="problem${problemCount}"><div class="search-element">
                <h3 class="element-title">Equipment</h3>
                <div class="search-element-bar">
                    <input type="text" placeholder="Enter Serial No." onkeyup="searchTable(event, 0)">
                    <button><i class="fa fa-search"></i></button>
                </div>
                <table class="search-element-table">
                    <tr>
                        <th>Serial No.</th>
                        <th>Type</th>
                        <th>Make</th>
                    </tr>
                    <tr>
                        <td>1234</td>
                        <td>Monitor</td>
                        <td>Asos</td>
                    </tr>
                    <tr>
                        <td>234</td>
                        <td>Printer</td>
                        <td>Icer</td>
                    </tr>
                    <tr class="selected-row">
                        <td>9456</td>
                        <td>Fridge</td>
                        <td>Samsung</td>
                    </tr>
                    <tr>
                        <td>0</td>
                        <td>Monitor</td>
                        <td>Apple</td>
                    </tr>
                </table>
            </div>

            <div class="search-element">
                <h3 class="element-title">Software</h3>
                <div class="search-element-bar">
                    <input type="text" placeholder="Enter name" onkeyup="searchTable(event, 0)">
                    <button><i class="fa fa-search"></i></button>
                </div>
                <div class="search-element-table-wrapper">
                <table class="search-element-table">
                    <tr>
                        <th>Software Name</th>
                        <th>Licensed</th>
                        <th>Supported</th>
                    </tr>
                    <tr>
                        <td>Microsoft Word</td>
                        <td><i class="fa fa-check-square"></i></td>
                        <td><i class="fa fa-check-square"></i></td>
                    </tr>
                </table>
                </div>
            </div>
            <div class="element-row">
                <div class="select-input-element">
                    <h3 class="element-title">Problem Type</h3>
                    <select>
                        <option value="" selected disabled hidden>Select a problem type</option>
                        <optgroup label="Printer">
                            <option>Printer</option>
                            <option>Printer Ink</option>
                            <option>Printer Paper</option>
                        </optgroup>
                        <optgroup label="Hardware">
                            <option>Hardware</option>
                            <option>GPU</option>
                            <option>RAM</option>
                        </optgroup>
                    </select>
                </div>

                <div class="select-input-element">
                    <h3 class="element-title">Operating System</h3>
                    <select>
                        <option value="" selected disabled hidden>Select an OS</option>
                        <option>Windows</option>
                        <option>iOS</option>
                        <option>Linux</option>
                        <option>Doesn't require OS</option>
                    </select>
                </div>
            </div>

            <div class="text-area-input-element">
                <h3 class="element-title">Problem Description</h3>
                <textarea class="scroll"></textarea>
            </div>

            <div class="element-row">
                <div class="select-input-element">
                    <h3 class="element-title">Branch</h3>
                    <select>
                        <option value="" selected disabled hidden>Select a branch</option>
                        <option>England</option>
                        <option>Germany</option>
                        <option>Japan</option>
                    </select>
                </div>
                <div class="select-input-element">
                    <h3 class="element-title">Priority</h3>
                    <select>
                        <option value="" selected disabled hidden>Select Priority</option>
                        <option>Low</option>
                        <option>Medium</option>
                        <option>High</option>
                        <option>I don't know</option>
                    </select>
                </div>

            </div>

            <div class="search-element night">
                <h3 class="element-title">Standard Solutions</h3>
                <div class="search-element-bar">
                    <input type="text" placeholder="Enter Problem Type" onkeyup="searchTable(event, 0)">
                    <button><i class="fa fa-search"></i></button>
                </div>
                <div class="search-element-table-wrapper">

                    <table class="search-element-table">
                        <tr>
                            <th>Solution Name</th>
                            <th>Problem Type</th>
                            <th>Description</th>
                        </tr>
                        <tr>
                            <td>Turn off and On again</td>
                            <td>General</td>
                            <td>Hold the power button until power is lost. Then power up again</td>
                        </tr>
                    </table>
                
                </div>
            </div>

            <div class="checkbox-input-element">
                <h3 class="element-title">Problem Status</h3>
                <input type="checkbox" id="solved" value="solved" onclick="checkSolved(event)">
                <label>Problem solved over the phone</label>
            </div>
            
            <div id="solved-form" class="hide-form">
                <div class="text-area-input-element">
                    <h3 class="element-title">How it was solved?</h3>
                    <textarea class="scroll"></textarea>
                </div>

                <div class="text-area-input-element">
                    <h3 class="element-title">Notes</h3>
                    <textarea class="scroll"></textarea>
                </div>
                <button class="big-button"><a href="./solvedProblems.html">Report Solved Problem</a></button>
            </div>

            <div id="unsolved-form">
                <div class="checkbox-input-element">
                    <h3 class="element-title">In Person Solving</h3>
                    <input type="checkbox">
                    <label>Problem must be solved in person</label>
                </div>

                <div class="search-element">
                    <h3 class="element-title">Specialist </h3>
                    <input type="checkbox" id="third-party" value="third-party" onClick="checkThirdParty(event)">
                    <label>3rd party specialist</label>

                    <div id="specialists">
                        <div class="search-element-bar">
                            <input type="text" placeholder="Enter Problem Type" onkeyup="searchTable(event, 2)"> 
                            <button><i class="fa fa-search"></i></button>
                        </div>
                        <table class="search-element-table">
                            <tr>
                                <th>Specialist Name</th>
                                <th>Branch</th>
                                <th>Expertise</th>
                                <th>No. Jobs</th>
                                <th>Part-Time</th>
                                <th>Status</th>
                                <th>In-Work</th>
                                <th>Next In Work</th>
                            </tr>
                            <tr>
                                <td>Sally</td>
                                <td>Germany</td>
                                <td>Printer</td>
                                <td>10</td>
                                <td></i></td>
                                <td>Avaliable</td>
                                <td><i class="fa fa-check-square"></i></td>
                                <td>20/20/2000</td>
                            </tr>
                            <tr class="selected-row">
                                <td>Susan</td>
                                <td>England</td>
                                <td>Washing Machines</td>
                                <td>10</td>
                                <td></td>
                                <td>Busy</td>
                                <td><i class="fa fa-check-square"></i></td>
                                <td>20/20/2000</td>
                            </tr>
                            <tr>
                                <td>Simon</td>
                                <td>England</td>
                                <td>Alexas</td>
                                <td>10</td>
                                <td><i class="fa fa-check-square"></i></td>
                                <td>Unavailable</td>
                                <td></td>
                                <td>20/20/2000</td>
                            </tr>
                            <tr>
                                <td>Sandre</td>
                                <td>Japan</td>
                                <td>Mac OS</td>
                                <td>10</td>
                                <td><i class="fa fa-check-square"></i></td>
                                <td>Avaliable</td>
                                <td><i class="fa fa-check-square"></i></td>
                                <td>20/20/2000</td>
                            </tr>
                            <tr>
                                <td>Sona</td>
                                <td>England</td>
                                <td>Anti-virus software</td>
                                <td>10</td>
                                <td></td>
                                <td>Avaliable</td>
                                <td><i class="fa fa-check-square"></i></td>
                                <td>20/20/2000</td>
                            </tr>
                        </table>
                    </div>

                    <div id="third-party-specialists" class="hide-form">
                        <div class="search-element-bar">
                            <input type="text" placeholder="Enter Problem Type" onkeyup="searchTable(event, 3)">
                            <button><i class="fa fa-search"></i></button>
                        </div>
                        <table class="search-element-table">
                            <tr>
                                <th>Third Party Specialist</th>
                                <th>Telephone</th>
                                <th>Active Jobs</th>
                                <th>Expertise</th>
                            </tr>
                            <tr class="selected-row">
                                <td>Dave</td>
                                <td>07123456789</td>
                                <td>10</td>
                                <td>Printers</td>
                            </tr>
                            <tr>
                                <td>Peter</td>
                                <td>01789456123</td>
                                <td>10</td>
                                <td>Printers</td>
                            </tr>
                        </table>
                    </div>

                </div>
            </div></div>`;

            const existingString = `<div data-name="problem${problemCount}" class="existing-problem">
                                        <div class="search-element">
                                        <h3 class="element-title">Solved Problems</h3>
                                        <div class="search-element-bar">
                                            <input type="text" placeholder="Enter problem type" onkeyup="searchTable(event, 4)">
                                            <button><i class="fa fa-search"></i></button>
                                        </div>
                                        <div class="search-element-table-wrapper">
                                        <table class="search-element-table">
                                            <tr>
                                                <th>Problem No.</th>
                                                <th>Status</th>
                                                <th>Date Solved</th>
                                                <th>Time Solved</th>
                                                <th>Problem Type</th>
                                                <th>Specialist ID</th>
                                                <th>External Specialist</th>
                                            </tr>
                                            <tr>
                                                <td>0</td>
                                                <td>Solved</td>
                                                <td>20/10/20</td>
                                                <td>5:30pm</td>
                                                <td>Printers</td>
                                                <td>ES001</td>
                                                <td><i class="fa fa-check-square"></i></td>
                                            </tr>
                                            <tr>
                                                <td>1</td>
                                                <td>Solved</td>
                                                <td>20/10/20</td>
                                                <td>5:33pm</td>
                                                <td>Software</td>
                                                <td>S001</td>
                                                <td></td>
                                            </tr>
                                            <tr>
                                                <td>2</td>
                                                <td>Solved</td>
                                                <td>21/10/20</td>
                                                <td>6:30pm</td>
                                                <td>Microsoft Word</td>
                                                <td>S002</td>
                                                <td></td>
                                            </tr>
                                            <tr>
                                                <td>3</td>
                                                <td>Solved</td>
                                                <td>22/10/20</td>
                                                <td>6:39pm</td>
                                                <td>PDF</td>
                                                <td>ES003</td>
                                                <td><i class="fa fa-check-square"></i></td>
                                            </tr>
                                            
                                        </table>
                                        </div>
                                    </div>
                                    </div>`;

            const tabString = `<div class="tablinks-container">
                                    <button class="tablinks" data-name="problem${problemCount}" onclick="openTab(event, 'problem${problemCount}')" id="defaultOpen">Problem ${problemCount}</button>
                                    <i data-name="problem${problemCount}" class="fa fa-times deletetab" onclick="deleteTab(event)"></i>
                                </div>`
            const tabContentString = `<div id="problem${problemCount}" class="tabcontent">
                                            <span onclick="this.parentElement.style.display='none'" class="topright">&times</span>
                                            <button onclick="chooseExisting(event)" data-name="problem${problemCount}" class="problem-tab-button">Existing Problem</button>
                                            <button onclick="chooseNew(event)" data-name="problem${problemCount}" class="problem-tab-button">New Problem</button>
                                            </br>
                                            ${problemString}
                                            ${existingString}
                                        </div>`;

            document.getElementById("tabs").insertAdjacentHTML('afterbegin', tabString);
            document.getElementById("tab-contents").insertAdjacentHTML('afterbegin', tabContentString);
            openTab(event, `problem${problemCount}` , true);
            tabCount++;
            problemCount++;
        }

        function chooseExisting(e) {
            const buttons = document.getElementsByClassName('problem-tab-button');
            for(var i = 0; i < buttons.length; i++) {
                if(buttons[i].dataset.name == e.target.dataset.name) {
                    buttons[i].classList.remove('active');
                }
            }
            e.target.classList.add('active');

            const newProblems = document.getElementsByClassName('new-problem');
            const existingProblems = document.getElementsByClassName('existing-problem');

            for(var i = 0; i < newProblems.length; i++) {
                if(newProblems[i].dataset.name == e.target.dataset.name) {
                    newProblems[i].style.display = 'none';
                }
            }

            for(var i = 0; i < existingProblems.length; i++) {
                if(existingProblems[i].dataset.name == e.target.dataset.name) {
                    existingProblems[i].style.display = 'block';
                }
            }
        }

        function chooseNew(e) {
            const buttons = document.getElementsByClassName('problem-tab-button');
            for(var i = 0; i < buttons.length; i++) {
                if(buttons[i].dataset.name == e.target.dataset.name) {
                    buttons[i].classList.remove('active');
                }
            }
            e.target.classList.add('active');

            const newProblems = document.getElementsByClassName('new-problem');
            const existingProblems = document.getElementsByClassName('existing-problem');

            for(var i = 0; i < newProblems.length; i++) {
                if(newProblems[i].dataset.name == e.target.dataset.name) {
                    newProblems[i].style.display = 'block';
                }
            }

            for(var i = 0; i < existingProblems.length; i++) {
                if(existingProblems[i].dataset.name == e.target.dataset.name) {
                    existingProblems[i].style.display = 'none';
                }
            }
        }

        // {
        //     call: {
        //         callerName,          TABLE 
        //         ext,                 TABLE
        //         date,                DATE NOW
        //         time,                TIME NOW
        //         operatorID           OPERATOR LOGGED IN
        //     }, 
        //     problems: [{}, {},...,{}]
        // }

        // problem : {
        //     serialNo,                TABLE   
        //     softwareName,            TABLE
        //     OS,                      DROPDOWN
        //     problemType,             DROPDOWN
        //     problemDescription,      TEXTAREA
        //     branch,                  DROPDOWN
        //     priority,                DROPDOWN
        //     status (solved?),        CHECKBOX
        //     inPerson,                CHECKBOX
        //     specialistID,            TABLE
        //     externalSpecialistID,    TABLE
        //     dateSolved,              NULL / DATE NOW
        //     timeSolved,              NULL / TIME NOW
        //     solveMethod,             TEXTAREA
        //     notes                    TEXTAREA
        // }

    </script>
    <script src="../../public/js/navs.js"></script>
    <script src="../../public/js/cssHelpers.js"></script>

</body>
</html>